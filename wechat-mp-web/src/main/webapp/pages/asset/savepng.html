#set($layout = "/layout/default.vm")

<div id="main" style="height: 400px; width: 100%; padding-top: 20;"></div>
<script type="text/javascript">
    var myChart = echarts.init(document.getElementById('main'));
    var option = {
        color: ['#87cefa', '#ff7f50'],
        title: {
            text: "$!{name}",
            x: "center" //标题水平方向位置
        },
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: ['沪深300', '累计净值'],
            y: 'bottom'
        },
        toolbox: {
            show: true,
            feature: {
                mark: {
                    show: false
                },
                dataView: {show: false, readOnly: true},
                magicType: {show: false, type: ['line', 'bar', 'stack', 'tiled']},
                restore: {show: false},
                saveAsImage: {show: true}
            }
        },
        calculable: false,
        grid: {
            borderWidth: 0,
            x:50,
            y:40,
            x2:10,
            y2:60
        },
        dataZoom: {
            show: true,
            realtime: true,
            start: 0,
            end: 100
        },
        xAxis: [
            {
                type: 'category',
                boundaryGap: false,
                splitLine: {
                    show: false,
                    onGap: null,
                    lineStyle: {
                        color: ['#fff'],
                        width: 0,
                        type: 'solid'
                    }
                },
                splitArea: {
                    show: false,
                    onGap: null,
                    areaStyle: {
                        color: ['rgba(0,0,0,0)']
                    }
                },
                data: $dates
            }
        ],
        yAxis: [
            {
                type: 'value',
                scale: true,
                precision: 2,
                splitNumber: 9,
                boundaryGap: [0.01, 0.01],
                splitLine: {
                    show: false,
                    onGap: null,
                    lineStyle: {
                        color: ['#fff'],
                        width: 0,
                        type: 'solid'
                    }
                },
                splitArea: {
                    show: false,
                    onGap: null,
                    areaStyle: {
                        color: ['rgba(0,0,0,0)']
                    }
                }
            }
        ],
        series: [
            {
                name: '沪深300',
                type: 'line',
                symbol: 'none',
                data: $hs
            },
            {
                name: '累计净值',
                type: 'line',
                symbol: 'none',
                data: $ab
            }
        ]
    };
    myChart.setOption(option);

    function exportImage(){
        var data = "a=" + myChart.getDataURL("png");
        var xmlhttp;
        if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else { // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.open("POST","<%=path%>/echarts/ExportsAction/saveImage",true);
        xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                alert(xmlhttp.responseText);
            }
        }
        xmlhttp.send(data);
    }
    setTimeout('exportImage()', 2000);
</script>
